import{importShared as o}from"./__federation_fn_import-CM5JTMvq.js";import{j as i}from"./jsx-runtime-NAwZxSSi.js";const{Box:N,Typography:A,styled:y}=await o("@mui/material"),D=y(N,{name:"WeatherWidget",slot:"root"})(({theme:e})=>({display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:e.spacing(0)})),W=y(A,{name:"WeatherWidget",slot:"title"})(()=>({}));W.defaultProps={variant:"h4"};const C=y(A,{name:"WeatherWidget",slot:"value"})(({theme:e})=>({marginTop:e.spacing(2)}));C.defaultProps={variant:"h1"};const{SubSettingsErrorsLogger:m,isGPSCoordinate:v,isValidObjectValue:P,isValidStringValue:f}=await o("@moderepo/biz-console");var n=(e=>(e.CELSIUS="C",e.FAHRENHEIT="F",e))(n||{});const x=(e,r)=>{const t=e;return!(!P(t,!0,r)||!f(t.title,!0,!0,void 0,new m(r,"title",t.title))||!v(t.location,new m(r,"location",t.location))||!f(t.unit,!1,!1,Object.values(n),new m(r,"unit",t.unit)))},w=()=>({title:"",location:{lat:35.78037262595157,lng:139.78598775403952}}),G=e=>({componentType:e,customSettings:w()}),F="https://api.open-meteo.com/v1/forecast?latitude={{LATITUDE}}&longitude={{LONGITUDE}}&current=temperature_2m",R=await o("react"),{useCallback:H,useEffect:L,useImperativeHandle:U,useMemo:I,useState:j}=R,{CircularProgress:O}=await o("@mui/material"),{APIError:V,ExternalAPI:M,FETCHING_DATA_STATUS:p,RequestMethod:q}=await o("@moderepo/biz-console"),g=R.forwardRef(({className:e,style:r,sx:t,id:u,compSettings:h},b)=>{const a=I(()=>h.customSettings??w(),[h.customSettings]),_=I(()=>({...t,...a.style}),[a.style,t]),[s,c]=j(p),l=H(async()=>{const E=await M.getInstance().sendRequest(q.GET,F.replace("{{LONGITUDE}}",a.location.lng.toString()).replace("{{LATITUDE}}",a.location.lat.toString()));if(!(E instanceof V)){const d=E.data.current.temperature_2m;typeof d=="number"?a.unit===n.FAHRENHEIT?c(d*9/5+32):c(d):c(void 0)}},[a.location.lat,a.location.lng,a.unit]);return U(b,()=>({getId:()=>u,getDataRequests:()=>{l()},onDataReady:()=>{}}),[u,l]),L(()=>{(s===p||s===void 0)&&l()},[l,s]),s===p?i.jsx(O,{}):i.jsxs(D,{id:u,className:e,style:r,sx:_,children:[i.jsx(W,{children:a.title}),i.jsx(C,{children:s!==void 0?i.jsxs(i.Fragment,{children:[s.toFixed(1),"Â°",a.unit??n.CELSIUS]}):i.jsx(i.Fragment,{children:"Unknown"})})]})});g.displayName="WeatherWidget";const{DEFAULT_WIDGET_MAIN_SETTING_TABS:z,EntityCustomSettingParamType:S,EntityViewCustomSettingsParamType:T,DEFAULT_WIDGET_STYLE_SETTING_TABS:k,CUSTOM_SETTINGS_STYLE_PARAM:B}=await o("@moderepo/biz-console"),Y={tabs:[{...z,params:[{paramType:T.PARAM,type:S.STRING,key:"title",label:"Title",description:"The title to be displayed",required:!0},{paramType:T.PARAM,type:S.GPS_COORDINATE,key:"location",label:"Location",description:"Select the location you want to show weather data for",required:!0},{paramType:T.PARAM,type:S.STRING,key:"unit",label:"Unit",description:"Select the unit to display the value in",required:!1,defaultValue:n.FAHRENHEIT,placeholder:"Default (Celsius)",options:[{label:"Celsius",value:n.CELSIUS},{label:"Fahrenheit",value:n.FAHRENHEIT}]}]},{...k,params:[B]}]},{BizConsolePluginType:Z,IconSource:J}=await o("@moderepo/biz-console"),X={type:Z.WIDGET,name:"Weather widget",widgetTypeSettings:{type:g.displayName,componentFunc:g,icon:{source:J.BIZ_CONSOLE,name:"TemperatureHumiditySensor"},displayName:"Weather Widget",description:"Widget that display the current temperature of the selected location",customSettingsValidator:x,createInitialEntityViewCompSettings:G,customSettingsSchema:Y}};export{n as TEMPERATURE_UNIT,g as WeatherWidget,X as bizConsolePlugin,w as createInitialWeatherWidgetCustomSettings,G as createInitialWeatherWidgetSettings,x as isWeatherWidgetCustomSettings,Y as weatherWidgetCustomSettingsSchema};

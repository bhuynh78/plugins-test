import{importShared as r}from"./__federation_fn_import-D30nUf9x.js";import{j as a}from"./jsx-runtime-NAwZxSSi.js";const{Box:q,Typography:N,styled:C}=await r("@mui/material"),P=C(q,{name:"WeatherWidget",slot:"root"})(({theme:t})=>({display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:t.spacing(0)})),D=C(N,{name:"WeatherWidget",slot:"title"})(()=>({}));D.defaultProps={variant:"h4"};const w=C(N,{name:"WeatherWidget",slot:"value"})(({theme:t})=>({marginTop:t.spacing(2)}));w.defaultProps={variant:"h1"};const{SubSettingsErrorsLogger:T,isGPSCoordinate:v,isValidObjectValue:x,isValidStringValue:h}=await r("@moderepo/biz-console");var u=(t=>(t.CELSIUS="C",t.FAHRENHEIT="F",t))(u||{});const V=(t,o)=>{const e=t;return!(!x(e,!0,o)||!h(e.title,!0,!0,void 0,new T(o,"title",e.title))||!v(e.location,new T(o,"location",e.location))||!h(e.unit,!1,!1,Object.values(u),new T(o,"unit",e.unit)))},U=()=>({title:"",location:{lat:35.78037262595157,lng:139.78598775403952}}),$=t=>({componentType:t,customSettings:U()}),k=(t,o)=>{const e=t;return!(!x(e,!0,o)||!h(e.title,!0,!0,void 0,new T(o,"title",e.title))||!v(e.location,new T(o,"location",e.location)))},G=()=>({title:"",location:{lat:35.78037262595157,lng:139.78598775403952}}),z=t=>({componentType:t,customSettings:G()}),B="https://api.open-meteo.com/v1/forecast?latitude={{LATITUDE}}&longitude={{LONGITUDE}}&current=temperature_2m",Y="https://api.open-meteo.com/v1/forecast?latitude={{LATITUDE}}&longitude={{LONGITUDE}}&current=relative_humidity_2m",F=await r("react"),{useCallback:Z,useEffect:J,useImperativeHandle:K,useMemo:_,useState:Q}=F,{CircularProgress:X}=await r("@mui/material"),{APIError:tt,ExternalAPI:et,FETCHING_DATA_STATUS:f,RequestMethod:it}=await r("@moderepo/biz-console"),A=F.forwardRef(({className:t,style:o,sx:e,id:l,compSettings:m},y)=>{const i=_(()=>m.customSettings??U(),[m.customSettings]),I=_(()=>({...e,...i.style}),[i.style,e]),[n,c]=Q(f),s=Z(async()=>{const p=await et.getInstance().sendRequest(it.GET,B.replace("{{LONGITUDE}}",i.location.lng.toString()).replace("{{LATITUDE}}",i.location.lat.toString()));if(!(p instanceof tt)){const d=p.data.current.temperature_2m;typeof d=="number"?i.unit===u.FAHRENHEIT?c(d*9/5+32):c(d):c(void 0)}},[i.location.lat,i.location.lng,i.unit]);return K(y,()=>({getId:()=>l,getDataRequests:()=>{s()},onDataReady:()=>{}}),[l,s]),J(()=>{(n===f||n===void 0)&&s()},[s,n]),n===f?a.jsx(X,{}):a.jsxs(P,{id:l,className:t,style:o,sx:I,children:[a.jsx(D,{children:i.title}),a.jsx(w,{children:n!==void 0?a.jsxs(a.Fragment,{children:[n.toFixed(1),"Â°",i.unit??u.CELSIUS]}):a.jsx(a.Fragment,{children:"Unknown"})})]})});A.displayName="TemperatureWidget";const{DEFAULT_WIDGET_MAIN_SETTING_TABS:j,EntityCustomSettingParamType:g,EntityViewCustomSettingsParamType:S,DEFAULT_WIDGET_STYLE_SETTING_TABS:L,CUSTOM_SETTINGS_STYLE_PARAM:M}=await r("@moderepo/biz-console"),at={tabs:[{...j,params:[{paramType:S.PARAM,type:g.STRING,key:"title",label:"Title",description:"The title to be displayed",required:!0},{paramType:S.PARAM,type:g.GPS_COORDINATE,key:"location",label:"Location",description:"Select the location you want to show temperature data for",required:!0},{paramType:S.PARAM,type:g.STRING,key:"unit",label:"Unit",description:"Select the unit to display the value in",required:!1,defaultValue:u.FAHRENHEIT,placeholder:"Default (Celsius)",options:[{label:"Celsius",value:u.CELSIUS},{label:"Fahrenheit",value:u.FAHRENHEIT}]}]},{...L,params:[M]}]},nt={tabs:[{...j,params:[{paramType:S.PARAM,type:g.STRING,key:"title",label:"Title",description:"The title to be displayed",required:!0},{paramType:S.PARAM,type:g.GPS_COORDINATE,key:"location",label:"Location",description:"Select the location you want to show temperature data for",required:!0}]},{...L,params:[M]}]},O=await r("react"),{useCallback:ot,useEffect:rt,useImperativeHandle:st,useMemo:b,useState:lt}=O,{CircularProgress:ut}=await r("@mui/material"),{APIError:ct,ExternalAPI:dt,FETCHING_DATA_STATUS:E,RequestMethod:mt}=await r("@moderepo/biz-console"),R=O.forwardRef(({className:t,style:o,sx:e,id:l,compSettings:m},y)=>{const i=b(()=>m.customSettings??G(),[m.customSettings]),I=b(()=>({...e,...i.style}),[i.style,e]),[n,c]=lt(E),s=ot(async()=>{const p=await dt.getInstance().sendRequest(mt.GET,Y.replace("{{LONGITUDE}}",i.location.lng.toString()).replace("{{LATITUDE}}",i.location.lat.toString()));if(!(p instanceof ct)){const d=p.data.current.relative_humidity_2m;c(typeof d=="number"?d:void 0)}},[i.location.lat,i.location.lng]);return st(y,()=>({getId:()=>l,getDataRequests:()=>{s()},onDataReady:()=>{}}),[l,s]),rt(()=>{(n===E||n===void 0)&&s()},[s,n]),n===E?a.jsx(ut,{}):a.jsxs(P,{id:l,className:t,style:o,sx:I,children:[a.jsx(D,{children:i.title}),a.jsx(w,{children:n!==void 0?a.jsxs(a.Fragment,{children:[n.toFixed(1),"%"]}):a.jsx(a.Fragment,{children:"Unknown"})})]})});R.displayName="HumidityWidget";const{BizConsolePluginType:W,IconSource:H}=await r("@moderepo/biz-console"),gt={plugins:[{type:W.DASHBOARD_WIDGET,name:"Temperature widget",widgetTypeSettings:{type:A.displayName,componentFunc:A,icon:{source:H.BIZ_CONSOLE,name:"TemperatureHumiditySensor"},displayName:"Temperature Widget",description:"Widget that display the current temperature of the selected location",customSettingsValidator:V,createInitialEntityViewCompSettings:$,customSettingsSchema:at}},{type:W.DASHBOARD_WIDGET,name:"Humidity widget",widgetTypeSettings:{type:R.displayName,componentFunc:R,icon:{source:H.MUI,name:"WaterDrop"},displayName:"Humidity Widget",description:"Widget that display the current humidity of the selected location",customSettingsValidator:k,createInitialEntityViewCompSettings:z,customSettingsSchema:nt}}]};export{R as HumidityWidget,u as TEMPERATURE_UNIT,A as TemperatureWidget,gt as bizConsolePlugins,G as createInitialHumidityWidgetCustomSettings,z as createInitialHumidityWidgetSettings,U as createInitialTemperatureWidgetCustomSettings,$ as createInitialTemperatureWidgetSettings,nt as humidityWidgetCustomSettingsSchema,k as isHumidityWidgetCustomSettings,V as isTemperatureWidgetCustomSettings,at as temperatureWidgetCustomSettingsSchema};
